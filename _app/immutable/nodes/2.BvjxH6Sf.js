import"../chunks/DsnmJJEf.js";import{x as $,y as He,M as Te,b7 as St,z as Nt,E as Ot,G as Ft,b8 as It,aV as Dt,b9 as Ut,ak as At,F as Bt,D as Ze,C as qe,a0 as Ct,ba as Ke,L as Tt,K as Pt,av as Wt,aD as Ae,r as Be,aC as jt,N as zt,q as Je,bb as Xt,I as Me,u as ht,bc as Vt,p as T,b as de,g as t,ae as N,k as I,o as _,v as b,s as f,t as X,ah as he,m as p,n as P,V as g,aN as be,b6 as te,bd as Ue,w as Z,be as Gt,ag as G,l as D,bf as oe,P as ne,bg as Yt,_ as ae,ad as Ge,bh as ge}from"../chunks/D4KbEBlY.js";import{p as re,i as V,r as ie,b as ce,c as Ht}from"../chunks/CJXYB7lu.js";import{f as Qe,c as $e,g as K,s as Se,d as Zt,h as et,e as ke,i as Ne,j as qt,r as De,k as tt,l as rt}from"../chunks/D9XZEmWM.js";import{b as Oe}from"../chunks/C_PBsP8N.js";function Kt(a,e,r,o,n,l){let s=$;$&&He();var d,c,i=null;$&&Te.nodeType===St&&(i=Te,He());var v=$?Te:a,m,w=$e;Nt(()=>{const y=e()||null;var x=It;if(y!==d){var L=$e;Qe(w),m&&(y===null?Tt(m,()=>{m=null,c=null}):y===c?Pt(m):(Wt(m),Ke(!1))),y&&y!==c&&(m=Ft(()=>{if(i=$?i:document.createElementNS(x,y),Dt(i,i),o){$&&Ut(y)&&i.append(document.createComment(""));var k=$?At(i):i.appendChild(Bt());$&&(k===null?Ze(!1):qe(k)),o(i,k)}Ct.nodes_end=i,v.before(i)})),d=y,d&&(c=d),Ke(!0),Qe(L)}},Ot),s&&(Ze(!0),qe(v))}function Jt(a,e,r=e){var o=Xt(),n=new WeakSet;Ae(a,"input",l=>{var s=l?a.defaultValue:a.value;if(s=We(a)?je(s):s,r(s),Me!==null&&n.add(Me),o&&s!==(s=e())){var d=a.selectionStart,c=a.selectionEnd;a.value=s??"",c!==null&&(a.selectionStart=d,a.selectionEnd=Math.min(c,a.value.length))}}),($&&a.defaultValue!==a.value||ht(e)==null&&a.value)&&(r(We(a)?je(a.value):a.value),Me!==null&&n.add(Me)),Be(()=>{var l=e();if(a===document.activeElement){var s=Vt??Me;if(n.has(s))return}We(a)&&l===je(a.value)||a.type==="date"&&!l&&!a.value||l!==a.value&&(a.value=l??"")})}const Pe=new Set;function at(a,e,r,o,n=o){var l=r.getAttribute("type")==="checkbox",s=a;let d=!1;if(e!==null)for(var c of e)s=s[c]??=[];s.push(r),Ae(r,"change",()=>{var i=r.__value;l&&(i=ot(s,i,r.checked)),n(i)},()=>n(l?[]:null)),Be(()=>{var i=o();if($&&r.defaultChecked!==r.checked){d=!0;return}l?(i=i||[],r.checked=i.includes(r.__value)):r.checked=jt(r.__value,i)}),zt(()=>{var i=s.indexOf(r);i!==-1&&s.splice(i,1)}),Pe.has(s)||(Pe.add(s),Je(()=>{s.sort((i,v)=>i.compareDocumentPosition(v)===4?-1:1),Pe.delete(s)})),Je(()=>{if(d){var i;if(l)i=ot(s,i,r.checked);else{var v=s.find(m=>m.checked);i=v?.__value}n(i)}})}function Qt(a,e,r=e){Ae(a,"change",o=>{var n=o?a.defaultChecked:a.checked;r(n)}),($&&a.defaultChecked!==a.checked||ht(e)==null)&&r(a.checked),Be(()=>{var o=e();a.checked=!!o})}function ot(a,e,r){for(var o=new Set,n=0;n<a.length;n+=1)a[n].checked&&o.add(a[n].__value);return r||o.delete(e),Array.from(o)}function We(a){var e=a.type;return e==="number"||e==="range"}function je(a){return a===""?null:+a}function $t(a,e,r=e){Ae(a,"change",()=>{r(a.files)}),$&&a.files&&r(a.files),Be(()=>{a.files=e()})}var er=I('<div><div class="flash bd-muted bg-accent"><label for="source_media" style="font-weight:bold;">Upload a video or image</label> <input id="source_media" name="source_media" type="file"/></div></div>');function gt(a,e){T(e,!0);const r=["video/mp4","video/webm"],o=["image/jpeg","image/png","image/gif"];let n=re(e,"current_file",15),l=re(e,"accept_video",3,!0),s=re(e,"accept_image",3,!0),d=he(()=>{const w=[];return l()&&w.push(...r),s()&&w.push(...o),w}),c=N(null);de(()=>{t(c)&&t(c).length>0?n(t(c)[0]):n(null)});var i=er(),v=_(i),m=b(_(v),2);f(v),f(i),X(w=>K(m,"accept",w),[()=>t(d).join(",")]),$t(m,()=>t(c),w=>g(c,w)),p(a,i),P()}function fe(a,e=!0){const r=Math.floor(a/3600).toString().padStart(2,"0"),o=Math.floor(a%3600/60).toString().padStart(2,"0"),n=Math.floor(a%60).toString().padStart(2,"0"),l=Math.floor(a%1*1e3).toString().padStart(3,"0"),s=`${o}:${n}.${l}`;return e?`${r}:${s}`:s}function tr(a,e,r=1e-4){return Math.abs(a-e)<r}function nt(a,e){g(e,!0),document.body.style.cursor="ew-resize"}function rr(a,e,r,o,n){if(!t(e)||!t(r)||!o.seekbar)return;const l=o.seekbar.getBoundingClientRect();let d=(a.touches[0].clientX-l.left)/(l.width-t(r).getBoundingClientRect().width);n(Math.max(0,Math.min(1,d))),o.seek_type==="handle"?o.on_seek?.(n()):o.on_seek?.(n(),!0)}var ar=I('<div class="p-.5 timer-display timer-text flash default unselectable svelte-wan5yw"> </div>'),or=I("<div><!></div>");function ze(a,e){T(e,!0);let r=re(e,"progress",7),o=N(!1),n=N(!1),l=N(null);function s(){!t(o)||!t(l)||!e.seekbar||(g(o,!1),document.body.style.cursor="auto",e.on_seek?.(r()))}function d(x){if(!t(o)||!t(l)||!e.seekbar)return;const L=e.seekbar.getBoundingClientRect();let k=(x.clientX-L.left)/(L.width-t(l).getBoundingClientRect().width);r(Math.max(0,Math.min(1,k))),e.seek_type==="handle"?e.on_seek?.(r()):e.on_seek?.(r(),!0)}function c(){if(!t(l)||!e.seekbar)return"0%";const x=e.seekbar.getBoundingClientRect();let L=(x.width-t(l).getBoundingClientRect().width)/x.width;return e.seek_type==="handle"||e.seek_type==="right_bracket"?`${r()*100*L}%`:`${r()*100}%`}var i=or();te("mouseup",Ue,s),te("mousemove",Ue,d);let v;i.__touchstart=[nt,o],i.__touchend=s,i.__touchmove=[rr,o,l,e,r],i.__mousedown=[nt,o],i.__mousemove=d;let m;var w=_(i);{var y=x=>{var L=ar(),k=_(L,!0);f(L),X(O=>Z(k,O),[()=>fe(r()*e.duration,!1)]),p(x,L)};V(w,x=>{(t(n)||t(o))&&x(y)})}f(i),Oe(i,x=>g(l,x),()=>t(l)),X((x,L)=>{v=Se(i,1,`draggable ${e.seek_type??""} unselectable`,"svelte-wan5yw",v,x),m=Zt(i,"",m,L)},[()=>({"z-index-100":t(n)||t(o)}),()=>({left:c()})]),te("touchcancel",i,s),te("mouseenter",i,()=>g(n,!0)),te("mouseleave",i,()=>g(n,!1)),p(a,i),P()}be(["touchstart","touchend","touchmove","mousedown","mousemove"]);var nr=I('<div class="parent svelte-hswmh"><div class="seekbar svelte-hswmh"><!> <!> <!></div></div>');function ir(a,e){T(e,!0);let r=N(null);var o=nr(),n=_(o),l=_(n);{let c=he(()=>e.video_data.start_progress??0);ze(l,{get progress(){return t(c)},seek_type:"left_bracket",get seekbar(){return t(r)},get on_seek(){return e.on_start_seek},get duration(){return e.video_data.duration}})}var s=b(l,2);{let c=he(()=>e.video_data.end_progress??100);ze(s,{get progress(){return t(c)},seek_type:"right_bracket",get seekbar(){return t(r)},get on_seek(){return e.on_end_seek},get duration(){return e.video_data.duration}})}var d=b(s,2);{let c=he(()=>e.video_data.progress??0);ze(d,{get progress(){return t(c)},seek_type:"handle",get seekbar(){return t(r)},get on_seek(){return e.on_seek},get duration(){return e.video_data.duration}})}f(n),Oe(n,c=>g(r,c),()=>t(r)),f(o),p(a,o),P()}/**
 * @license @lucide/svelte v0.536.0 - ISC
 *
 * ISC License
 * 
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2022 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2022.
 * 
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 * 
 */const sr={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":2,"stroke-linecap":"round","stroke-linejoin":"round"};var lr=Gt("<svg><!><!></svg>");function ue(a,e){T(e,!0);const r=re(e,"color",3,"currentColor"),o=re(e,"size",3,24),n=re(e,"strokeWidth",3,2),l=re(e,"absoluteStrokeWidth",3,!1),s=re(e,"iconNode",19,()=>[]),d=ie(e,["$$slots","$$events","$$legacy","name","color","size","strokeWidth","absoluteStrokeWidth","iconNode","children"]);var c=lr();et(c,m=>({...sr,...d,width:o(),height:o(),stroke:r(),"stroke-width":m,class:["lucide-icon lucide",e.name&&`lucide-${e.name}`,e.class]}),[()=>l()?Number(n())*24/Number(o()):n()]);var i=_(c);ke(i,17,s,Ne,(m,w)=>{var y=he(()=>Yt(t(w),2));let x=()=>t(y)[0],L=()=>t(y)[1];var k=G(),O=D(k);Kt(O,x,!0,(z,H)=>{et(z,()=>({...L()}))}),p(m,k)});var v=b(i);oe(v,()=>e.children??ne),f(c),p(a,c),P()}function dr(a,e){T(e,!0);/**
 * @license @lucide/svelte v0.536.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2022 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2022.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 */let r=ie(e,["$$slots","$$events","$$legacy"]);const o=[["circle",{cx:"12",cy:"12",r:"10"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16"}]];ue(a,ce({name:"circle-alert"},()=>r,{get iconNode(){return o},children:(n,l)=>{var s=G(),d=D(s);oe(d,()=>e.children??ne),p(n,s)},$$slots:{default:!0}})),P()}function cr(a,e){T(e,!0);/**
 * @license @lucide/svelte v0.536.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2022 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2022.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 */let r=ie(e,["$$slots","$$events","$$legacy"]);const o=[["path",{d:"M6 16c5 0 7-8 12-8a4 4 0 0 1 0 8c-5 0-7-8-12-8a4 4 0 1 0 0 8"}]];ue(a,ce({name:"infinity"},()=>r,{get iconNode(){return o},children:(n,l)=>{var s=G(),d=D(s);oe(d,()=>e.children??ne),p(n,s)},$$slots:{default:!0}})),P()}function ur(a,e){T(e,!0);/**
 * @license @lucide/svelte v0.536.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2022 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2022.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 */let r=ie(e,["$$slots","$$events","$$legacy"]);const o=[["circle",{cx:"12",cy:"12",r:"10"}],["path",{d:"M12 16v-4"}],["path",{d:"M12 8h.01"}]];ue(a,ce({name:"info"},()=>r,{get iconNode(){return o},children:(n,l)=>{var s=G(),d=D(s);oe(d,()=>e.children??ne),p(n,s)},$$slots:{default:!0}})),P()}function fr(a,e){T(e,!0);/**
 * @license @lucide/svelte v0.536.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2022 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2022.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 */let r=ie(e,["$$slots","$$events","$$legacy"]);const o=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1"}]];ue(a,ce({name:"pause"},()=>r,{get iconNode(){return o},children:(n,l)=>{var s=G(),d=D(s);oe(d,()=>e.children??ne),p(n,s)},$$slots:{default:!0}})),P()}function _r(a,e){T(e,!0);/**
 * @license @lucide/svelte v0.536.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2022 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2022.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 */let r=ie(e,["$$slots","$$events","$$legacy"]);const o=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z"}]];ue(a,ce({name:"play"},()=>r,{get iconNode(){return o},children:(n,l)=>{var s=G(),d=D(s);oe(d,()=>e.children??ne),p(n,s)},$$slots:{default:!0}})),P()}function vr(a,e){T(e,!0);/**
 * @license @lucide/svelte v0.536.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2022 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2022.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 */let r=ie(e,["$$slots","$$events","$$legacy"]);const o=[["path",{d:"m17 2 4 4-4 4"}],["path",{d:"M3 11v-1a4 4 0 0 1 4-4h14"}],["path",{d:"m7 22-4-4 4-4"}],["path",{d:"M21 13v1a4 4 0 0 1-4 4H3"}],["path",{d:"M11 10h1v4"}]];ue(a,ce({name:"repeat-1"},()=>r,{get iconNode(){return o},children:(n,l)=>{var s=G(),d=D(s);oe(d,()=>e.children??ne),p(n,s)},$$slots:{default:!0}})),P()}function mr(a,e){T(e,!0);/**
 * @license @lucide/svelte v0.536.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2022 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2022.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 */let r=ie(e,["$$slots","$$events","$$legacy"]);const o=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2"}]];ue(a,ce({name:"square"},()=>r,{get iconNode(){return o},children:(n,l)=>{var s=G(),d=D(s);oe(d,()=>e.children??ne),p(n,s)},$$slots:{default:!0}})),P()}function hr(a,e){T(e,!0);/**
 * @license @lucide/svelte v0.536.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2022 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2022.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 */let r=ie(e,["$$slots","$$events","$$legacy"]);const o=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z"}],["path",{d:"M16 9a5 5 0 0 1 0 6"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728"}]];ue(a,ce({name:"volume-2"},()=>r,{get iconNode(){return o},children:(n,l)=>{var s=G(),d=D(s);oe(d,()=>e.children??ne),p(n,s)},$$slots:{default:!0}})),P()}function gr(a,e){T(e,!0);/**
 * @license @lucide/svelte v0.536.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2022 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2022.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 */let r=ie(e,["$$slots","$$events","$$legacy"]);const o=[["path",{d:"M16 9a5 5 0 0 1 .95 2.293"}],["path",{d:"M19.364 5.636a9 9 0 0 1 1.889 9.96"}],["path",{d:"m2 2 20 20"}],["path",{d:"m7 7-.587.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298V11"}],["path",{d:"M9.828 4.172A.686.686 0 0 1 11 4.657v.686"}]];ue(a,ce({name:"volume-off"},()=>r,{get iconNode(){return o},children:(n,l)=>{var s=G(),d=D(s);oe(d,()=>e.children??ne),p(n,s)},$$slots:{default:!0}})),P()}function it(a,e){T(e,!0);/**
 * @license @lucide/svelte v0.536.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2022 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2022.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 */let r=ie(e,["$$slots","$$events","$$legacy"]);const o=[["path",{d:"M18 6 6 18"}],["path",{d:"m6 6 12 12"}]];ue(a,ce({name:"x"},()=>r,{get iconNode(){return o},children:(n,l)=>{var s=G(),d=D(s);oe(d,()=>e.children??ne),p(n,s)},$$slots:{default:!0}})),P()}function pr(a,e,r){e()&&(e().pause(),r())}function br(a,e,r,o){e()&&((e().ended||tr(r.video_data.progress,r.video_data.end_progress))&&o(),e().play())}var wr=(a,e)=>e()?.pause(),yr=I('<button class="bd-accent svelte-m6aj9m"><!></button>'),xr=I('<button class="svelte-m6aj9m"><!></button>'),kr=(a,e)=>g(e,!t(e)),Er=(a,e)=>g(e,!t(e)),Rr=I('<div class="controls-container svelte-m6aj9m"><div class="controls svelte-m6aj9m"><!> <button class="svelte-m6aj9m"><!></button> <div class="timer-text flash accent svelte-m6aj9m"> </div></div> <div class="controls svelte-m6aj9m"><button><!></button> <button><!></button></div></div>');function Mr(a,e){T(e,!0);let r=re(e,"video",7);de(()=>{r()&&(r().addEventListener("play",()=>g(o,!0)),r().addEventListener("pause",()=>g(o,!1)),r().addEventListener("ended",()=>g(o,!1)),r().addEventListener("loadstart",()=>g(o,!1)))});let o=N(!1),n=N(!0),l=N(!0);function s(){!r()||!e.video_data||(r().currentTime=e.video_data.start_progress*e.video_data.duration)}de(()=>{r()&&(r().loop=t(n),r().muted=!t(l))});var d=Rr(),c=_(d),i=_(c);{var v=h=>{var E=yr();E.__click=[wr,r];var R=_(E);fr(R,{}),f(E),p(h,E)},m=h=>{var E=xr();E.__click=[br,r,e,s];var R=_(E);_r(R,{}),f(E),p(h,E)};V(i,h=>{t(o)?h(v):h(m,!1)})}var w=b(i,2);w.__click=[pr,r,s];var y=_(w);mr(y,{}),f(w);var x=b(w,2),L=_(x);f(x),f(c);var k=b(c,2),O=_(k);O.__click=[kr,n];let z;var H=_(O);{var J=h=>{cr(h,{})},B=h=>{vr(h,{})};V(H,h=>{t(n)?h(J):h(B,!1)})}f(O);var C=b(O,2);C.__click=[Er,l];let Y;var M=_(C);{var A=h=>{hr(h,{})},u=h=>{gr(h,{})};V(M,h=>{t(l)?h(A):h(u,!1)})}f(C),f(k),f(d),X((h,E,R,F)=>{Z(L,`${h??""} / ${E??""}`),z=Se(O,1,"svelte-m6aj9m",null,z,R),Y=Se(C,1,"svelte-m6aj9m",null,Y,F)},[()=>fe(e.video_data.current_time,!1),()=>fe(e.video_data.duration,!1),()=>({"bd-accent":t(n)}),()=>({"bd-accent":t(l)})]),p(a,d),P()}be(["click"]);const st=["NW","N","NE","W","E","SW","S","SE"],Lr="#000000E6",q=12,lt=64;function xe(){return{enabled:t(pt),x:t(Le)?.origin.x||0,y:t(Le)?.origin.y||0,width:t(Le)?.width||0,height:t(Le)?.height||0}}let Le=N(null),pt=N(!1);function Sr(a,e,r,o,n,l){if(!t(e))return;const s=t(e).getBoundingClientRect(),d=a.clientX-s.left,c=a.clientY-s.top,i=r({x:d,y:c});if(i){i==="surface"?(t(e).style.cursor="move",g(o,{x:d,y:c},!0)):t(e).style.cursor=`${i}-resize`,g(n,!0),g(l,i,!0);return}}var Nr=I('<canvas class="svelte-1frae8d"></canvas> <div><code> </code></div>',1);function Or(a,e){T(e,!0);let r=N(null),o=N(ae({width:0,height:0})),n=N(ae({width:0,height:0})),l=N(!1),s=N(!1),d=N(ae({x:0,y:0})),c=N("NW"),i=N(ae({p0:{x:0,y:0},p1:{x:t(o).width,y:t(o).height}}));Ge(()=>{window.addEventListener("resize",m)}),de(()=>{e.video&&e.video.addEventListener("loadedmetadata",m)}),de(()=>{g(Le,t(v),!0),g(pt,t(v).width<t(n).width||t(v).height<t(n).height,!0)});let v=he(()=>{if(!t(r)||!e.video)return{origin:{x:0,y:0},width:0,height:0};const u=e.video.videoWidth/e.video.offsetWidth,h=Math.min(Math.round((t(i).p1.x-t(i).p0.x)*u),t(n).width),E=Math.min(Math.round((t(i).p1.y-t(i).p0.y)*u),t(n).height);return{origin:{x:Math.round(t(i).p0.x*u),y:Math.round(t(i).p0.y*u)},width:h,height:E}});function m(){!t(r)||!e.video||(g(o,{width:e.video.offsetWidth,height:e.video.offsetHeight},!0),g(n,{width:e.video.videoWidth,height:e.video.videoHeight},!0),g(i,{p0:{x:0,y:0},p1:{x:t(o).width,y:t(o).height}},!0))}function w(){if(!t(r))return;const u=t(r).getContext("2d");u&&(u.clearRect(0,0,t(o).width,t(o).height),y(u),t(s)&&(x(u),L(u)))}function y(u){u.fillStyle=Lr,u.fillRect(0,0,t(i).p0.x,t(i).p0.y),u.fillRect(t(i).p0.x,0,t(i).p1.x-t(i).p0.x,t(i).p0.y),u.fillRect(t(i).p1.x,0,t(o).width-t(i).p1.x,t(i).p0.y),u.fillRect(0,t(i).p0.y,t(i).p0.x,t(i).p1.y-t(i).p0.y),u.fillRect(t(i).p1.x,t(i).p0.y,t(o).width-t(i).p1.x,t(i).p1.y-t(i).p0.y),u.fillRect(0,t(i).p1.y,t(i).p0.x,t(o).height-t(i).p1.y),u.fillRect(t(i).p0.x,t(i).p1.y,t(i).p1.x-t(i).p0.x,t(o).height-t(i).p1.y),u.fillRect(t(i).p1.x,t(i).p1.y,t(o).width-t(i).p1.x,t(o).height-t(i).p1.y)}function x(u){u.strokeStyle="#FFF",u.lineWidth=2,u.strokeRect(t(i).p0.x,t(i).p0.y,t(i).p1.x-t(i).p0.x,t(i).p1.y-t(i).p0.y),u.strokeStyle="#111",u.lineWidth=2,u.strokeRect(t(i).p0.x+2,t(i).p0.y+2,t(i).p1.x-t(i).p0.x-4,t(i).p1.y-t(i).p0.y-4)}function L(u){if(!t(r))return;u.fillStyle="#FFF",u.strokeStyle="#111",u.lineWidth=1;const h=k();for(const E of st){const R=h[E];u.fillRect(R.x,R.y,q,q),u.strokeRect(R.x,R.y,q,q)}}de(()=>{!t(r)||!t(r).getContext("2d")||w()});function k(){const u=t(i).p1.x-t(i).p0.x,h=t(i).p1.y-t(i).p0.y,E=t(i).p0.x+u/2-q/2,R=t(i).p0.y+h/2-q/2;return{NW:{x:t(i).p0.x,y:t(i).p0.y},N:{x:E,y:t(i).p0.y},NE:{x:t(i).p1.x-q,y:t(i).p0.y},W:{x:t(i).p0.x,y:R},E:{x:t(i).p1.x-q,y:R},SW:{x:t(i).p0.x,y:t(i).p1.y-q},S:{x:E,y:t(i).p1.y-q},SE:{x:t(i).p1.x-q,y:t(i).p1.y-q}}}function O({x:u,y:h}){const E=k();for(const R of st){const F=E[R];if(u>=F.x&&u<=F.x+q&&h>=F.y&&h<=F.y+q)return R}return u>=t(i).p0.x&&u<=t(i).p1.x&&h>=t(i).p0.y&&h<=t(i).p1.y?"surface":null}function z(u){!t(r)||!t(l)||(t(r).style.cursor="auto",g(l,!1))}function H(u){if(!t(r))return;if(!t(l)){const S=t(r).getBoundingClientRect(),W=u.clientX-S.left,j=u.clientY-S.top,Q=O({x:W,y:j});Q?Q==="surface"?(t(r).style.cursor="move",g(s,!0)):(t(r).style.cursor=`${Q}-resize`,g(s,!1)):(t(r).style.cursor="auto",g(s,!1));return}const h=t(r).getBoundingClientRect(),E=u.clientX-h.left,R=u.clientY-h.top;if(t(c)==="surface"){const S=E-t(d).x,W=R-t(d).y,j={p0:{x:t(i).p0.x+S,y:t(i).p0.y+W},p1:{x:t(i).p1.x+S,y:t(i).p1.y+W}};j.p0.x>0&&j.p1.x<t(o).width&&(t(i).p0.x=j.p0.x,t(i).p1.x=j.p1.x),j.p0.y>0&&j.p1.y<t(o).height&&(t(i).p0.y=j.p0.y,t(i).p1.y=j.p1.y),g(d,{x:E,y:R},!0)}else{let S={p0:{...t(i).p0},p1:{...t(i).p1}};t(c).includes("N")?S.p0.y=Math.max(0,Math.min(t(i).p1.y,R)):t(c).includes("S")&&(S.p1.y=Math.min(t(o).height,Math.max(t(i).p0.y,R))),S.p1.y-S.p0.y>=lt&&(t(i).p0.y=S.p0.y,t(i).p1.y=S.p1.y),t(c).includes("W")?S.p0.x=Math.max(0,Math.min(t(i).p1.x,E)):t(c).includes("E")&&(S.p1.x=Math.min(t(o).width,Math.max(t(i).p0.x,E))),S.p1.x-S.p0.x>=lt&&(t(i).p0.x=S.p0.x,t(i).p1.x=S.p1.x)}t(r).getContext("2d")&&w()}function J(){t(l)||g(s,!1)}var B=Nr();te("mouseup",Ue,z),te("mousemove",Ue,H);var C=D(B);C.__mousedown=[Sr,r,O,d,l,c],Oe(C,u=>g(r,u),()=>t(r));var Y=b(C,2),M=_(Y),A=_(M);f(M),f(Y),X(()=>{K(C,"width",t(o).width),K(C,"height",t(o).height),Z(A,`Cropped: ${t(v).width??""} x ${t(v).height??""} - Original: ${t(n).width??""} x ${t(n).height??""}`)}),te("mouseenter",C,onmouseenter),te("mouseleave",C,J),p(a,B),P()}be(["mousedown"]);var Fr=I("<li> </li>"),Ir=I('<div class="flash muted"><ul><p><b>Log</b></p> <!></ul></div>');function bt(a,e){T(e,!0);const r=()=>(e.ffmpeg_manager.is_loaded()&&e.message_manager.toggle_ffmpeg_listen(!0,e.ffmpeg_manager),()=>{e.message_manager.toggle_ffmpeg_listen(!1,e.ffmpeg_manager)});var o=Ir(),n=_(o),l=b(_(n),2);ke(l,17,()=>Object.values(e.message_manager.messages),Ne,(s,d)=>{var c=Fr();let i;var v=_(c,!0);f(c),X(m=>{i=Se(c,1,"svelte-w19oiv",null,i,m),Z(v,t(d).message)},[()=>({error:t(d).error})]),p(s,c)}),f(n),f(o),qt(o,()=>r),p(a,o),P()}let wt={};const dt=new WeakMap,ct={metric:[{from:0,to:1e3,unit:"B",long:"bytes"},{from:1e3,to:1e6,unit:"kB",long:"kilobytes"},{from:1e6,to:1e9,unit:"MB",long:"megabytes"},{from:1e9,to:1e12,unit:"GB",long:"gigabytes"},{from:1e12,to:1e15,unit:"TB",long:"terabytes"},{from:1e15,to:1e18,unit:"PB",long:"petabytes"},{from:1e18,to:1e21,unit:"EB",long:"exabytes"},{from:1e21,to:1e24,unit:"ZB",long:"zettabytes"},{from:1e24,to:1e27,unit:"YB",long:"yottabytes"}],metric_octet:[{from:0,to:1e3,unit:"o",long:"octets"},{from:1e3,to:1e6,unit:"ko",long:"kilooctets"},{from:1e6,to:1e9,unit:"Mo",long:"megaoctets"},{from:1e9,to:1e12,unit:"Go",long:"gigaoctets"},{from:1e12,to:1e15,unit:"To",long:"teraoctets"},{from:1e15,to:1e18,unit:"Po",long:"petaoctets"},{from:1e18,to:1e21,unit:"Eo",long:"exaoctets"},{from:1e21,to:1e24,unit:"Zo",long:"zettaoctets"},{from:1e24,to:1e27,unit:"Yo",long:"yottaoctets"}],iec:[{from:0,to:Math.pow(1024,1),unit:"B",long:"bytes"},{from:Math.pow(1024,1),to:Math.pow(1024,2),unit:"KiB",long:"kibibytes"},{from:Math.pow(1024,2),to:Math.pow(1024,3),unit:"MiB",long:"mebibytes"},{from:Math.pow(1024,3),to:Math.pow(1024,4),unit:"GiB",long:"gibibytes"},{from:Math.pow(1024,4),to:Math.pow(1024,5),unit:"TiB",long:"tebibytes"},{from:Math.pow(1024,5),to:Math.pow(1024,6),unit:"PiB",long:"pebibytes"},{from:Math.pow(1024,6),to:Math.pow(1024,7),unit:"EiB",long:"exbibytes"},{from:Math.pow(1024,7),to:Math.pow(1024,8),unit:"ZiB",long:"zebibytes"},{from:Math.pow(1024,8),to:Math.pow(1024,9),unit:"YiB",long:"yobibytes"}],iec_octet:[{from:0,to:Math.pow(1024,1),unit:"o",long:"octets"},{from:Math.pow(1024,1),to:Math.pow(1024,2),unit:"Kio",long:"kibioctets"},{from:Math.pow(1024,2),to:Math.pow(1024,3),unit:"Mio",long:"mebioctets"},{from:Math.pow(1024,3),to:Math.pow(1024,4),unit:"Gio",long:"gibioctets"},{from:Math.pow(1024,4),to:Math.pow(1024,5),unit:"Tio",long:"tebioctets"},{from:Math.pow(1024,5),to:Math.pow(1024,6),unit:"Pio",long:"pebioctets"},{from:Math.pow(1024,6),to:Math.pow(1024,7),unit:"Eio",long:"exbioctets"},{from:Math.pow(1024,7),to:Math.pow(1024,8),unit:"Zio",long:"zebioctets"},{from:Math.pow(1024,8),to:Math.pow(1024,9),unit:"Yio",long:"yobioctets"}]};class Dr{constructor(e,r){r=Object.assign({units:"metric",precision:1,locale:void 0},wt,r),dt.set(this,r),Object.assign(ct,r.customUnits);const o=e<0?"-":"";e=Math.abs(e);const n=ct[r.units];if(n){const l=n.find(s=>e>=s.from&&e<s.to);if(l){const s=new Intl.NumberFormat(r.locale,{style:"decimal",maximumFractionDigits:r.precision}),d=l.from===0?o+s.format(e):o+s.format(e/l.from);this.value=d,this.unit=l.unit,this.long=l.long}else this.value=o+e,this.unit="",this.long=""}else throw new Error(`Invalid units specified: ${r.units}`)}toString(){const e=dt.get(this);return e.toStringFn?e.toStringFn.bind(this)():`${this.value} ${this.unit}`}}function Ee(a,e){return new Dr(a,e)}Ee.defaultOptions=function(a){wt=a};var Ur=I('<div class="flash danger"><p><!> </p></div>'),Ar=I(`<div class="flash danger"><p><!> Estimated file size too large: <code> </code>. Reduce either duration or
			bitrate.</p></div>`),Br=I("<!> <!>",1);function Cr(a,e){T(e,!0);const r=120,o=4096*1024;let n=he(()=>{if(!e.export_settings.settings||!e.export_settings.settings.bitrate)return 0;const v=e.export_settings.settings.bitrate;return(e.video_data.end_progress-e.video_data.start_progress)*e.video_data.duration*v*1e3/8});var l=Br(),s=D(l);{var d=v=>{var m=Ur(),w=_(m),y=_(w);it(y,{style:"vertical-align:text-bottom;"});var x=b(y);f(w),f(m),X(L=>Z(x,` Duration too long: Current: ${L??""} seconds, Limit: 120 seconds`),[()=>((e.video_data.end_progress-e.video_data.start_progress)*e.video_data.duration).toFixed(2)]),p(v,m)};V(s,v=>{(e.video_data.end_progress-e.video_data.start_progress)*e.video_data.duration>r&&v(d)})}var c=b(s,2);{var i=v=>{var m=Ar(),w=_(m),y=_(w);it(y,{style:"vertical-align:text-bottom;"});var x=b(y,2),L=_(x);f(x),ge(),f(w),f(m),X((k,O)=>Z(L,`${k??""}/${O??""}`),[()=>Ee(t(n)),()=>Ee(o)]),p(v,m)};V(c,v=>{t(n)>o&&v(i)})}p(a,l),P()}const Tr=["none","film","animation","stillimage","zerolatency"],Pr=["None","Film","Animation","Still Image","Zero Latency"],Wr=["ultrafast","superfast","veryfast","faster","fast","medium","slow","slower","veryslow"],jr=["Ultra Fast","Super Fast","Very Fast","Faster","Fast","Medium","Slow","Slower","Very Slow"],zr=/\[sound=(?<url>.*)]/,Xr=["jpg","jpeg","png","gif"],Vr=["mp4","webm","mkv"],Gr=["mp3","wav","ogg"];function ut(a){const e=a.match(zr);let r=null;return e&&e.groups&&e.groups.url&&(r=decodeURIComponent(e.groups.url),r.startsWith("http")||(r="https://"+r)),r}function Xe(a){const e=a.split(".").pop()?.toLowerCase();if(e){if(Xr.includes(e))return"image";if(Vr.includes(e))return"video";if(Gr.includes(e))return"audio"}return"unknown"}function yt(a){return Xe(a)==="image"}function Yr(a){return a.replaceAll(/\[.+?\]/g,"").split(".")[0].trim()}var Hr=I("<option> </option>"),Zr=I("<option> </option>"),qr=I(`<fieldset><legend>Preset</legend> <p>Slower will yield higher quality encodes.</p> <select></select></fieldset> <fieldset><legend>Tune</legend> <p>Optimize the output for specific content types. <br/>Pick <i>Still Image</i> if your input is
				an image file.</p> <select></select></fieldset>`,1),Kr=I('<div class="flash bd-muted"><p><b>FFmpeg settings</b></p> <fieldset><legend>Output format</legend> <p>MP4 highly recommended.</p> <div><label><input type="radio" name="output_format"/> MP4 (H.264)</label> <label><input type="radio" name="output_format"/> WebM (VP8 + 256k Vorbis)</label></div></fieldset> <fieldset><legend>Target Bitrate</legend> <input name="bitrate_range" type="range" min="256" max="16384" step="256"/> <label for="bitrate_range"> </label></fieldset> <!></div>');function xt(a,e){T(e,!0);const r=[];let o=re(e,"export_settings",15),n=N("fast"),l=N(2048),s=N("mp4"),d=he(()=>yt(e.file_name)?"stillimage":"none");de(()=>{o()&&(t(s)==="mp4"?o(o().settings={preset:t(n),tune:t(d),bitrate:t(l)},!0):t(s)==="webm"&&o(o().settings={bitrate:t(l)},!0),o(o().output_format=t(s),!0))});var c=Kr(),i=b(_(c),2),v=b(_(i),4),m=_(v),w=_(m);De(w),w.value=w.__value="mp4",ge(),f(m);var y=b(m,2),x=_(y);De(x),x.value=x.__value="webm",ge(),f(y),f(v),f(i);var L=b(i,2),k=b(_(L),2);De(k);var O=b(k,2),z=_(O);f(O),f(L);var H=b(L,2);{var J=B=>{var C=qr(),Y=D(C),M=b(_(Y),4);ke(M,21,()=>Wr,Ne,(h,E,R)=>{var F=Hr(),S=_(F,!0);f(F);var W={};X(()=>{tt(F,t(n)===t(E)),Z(S,jr[R]),W!==(W=t(E))&&(F.value=(F.__value=t(E))??"")}),p(h,F)}),f(M),f(Y);var A=b(Y,2),u=b(_(A),4);ke(u,21,()=>Tr,Ne,(h,E,R)=>{var F=Zr(),S=_(F,!0);f(F);var W={};X(()=>{tt(F,t(d)===t(E)),Z(S,Pr[R]),W!==(W=t(E))&&(F.value=(F.__value=t(E))??"")}),p(h,F)}),f(u),f(A),rt(M,()=>t(n),h=>g(n,h)),rt(u,()=>t(d),h=>g(d,h)),p(B,C)};V(H,B=>{t(s)==="mp4"&&B(J)})}f(c),X(B=>Z(z,`Up to ${B??""}/s`),[()=>Ee(t(l)*1e3/8)]),at(r,[],w,()=>t(s),B=>g(s,B)),at(r,[],x,()=>t(s),B=>g(s,B)),Jt(k,()=>t(l),B=>g(l,B)),p(a,c),P()}var U;(function(a){a.LOAD="LOAD",a.EXEC="EXEC",a.FFPROBE="FFPROBE",a.WRITE_FILE="WRITE_FILE",a.READ_FILE="READ_FILE",a.DELETE_FILE="DELETE_FILE",a.RENAME="RENAME",a.CREATE_DIR="CREATE_DIR",a.LIST_DIR="LIST_DIR",a.DELETE_DIR="DELETE_DIR",a.ERROR="ERROR",a.DOWNLOAD="DOWNLOAD",a.PROGRESS="PROGRESS",a.LOG="LOG",a.MOUNT="MOUNT",a.UNMOUNT="UNMOUNT"})(U||(U={}));const Jr=(()=>{let a=0;return()=>a++})(),Qr=new Error("ffmpeg is not loaded, call `await ffmpeg.load()` first"),$r=new Error("called FFmpeg.terminate()");class ea{#e=null;#a={};#r={};#o=[];#n=[];loaded=!1;#i=()=>{this.#e&&(this.#e.onmessage=({data:{id:e,type:r,data:o}})=>{switch(r){case U.LOAD:this.loaded=!0,this.#a[e](o);break;case U.MOUNT:case U.UNMOUNT:case U.EXEC:case U.FFPROBE:case U.WRITE_FILE:case U.READ_FILE:case U.DELETE_FILE:case U.RENAME:case U.CREATE_DIR:case U.LIST_DIR:case U.DELETE_DIR:this.#a[e](o);break;case U.LOG:this.#o.forEach(n=>n(o));break;case U.PROGRESS:this.#n.forEach(n=>n(o));break;case U.ERROR:this.#r[e](o);break}delete this.#a[e],delete this.#r[e]})};#t=({type:e,data:r},o=[],n)=>this.#e?new Promise((l,s)=>{const d=Jr();this.#e&&this.#e.postMessage({id:d,type:e,data:r},o),this.#a[d]=l,this.#r[d]=s,n?.addEventListener("abort",()=>{s(new DOMException(`Message # ${d} was aborted`,"AbortError"))},{once:!0})}):Promise.reject(Qr);on(e,r){e==="log"?this.#o.push(r):e==="progress"&&this.#n.push(r)}off(e,r){e==="log"?this.#o=this.#o.filter(o=>o!==r):e==="progress"&&(this.#n=this.#n.filter(o=>o!==r))}load=({classWorkerURL:e,...r}={},{signal:o}={})=>(this.#e||(this.#e=e?new Worker(new URL(e,import.meta.url),{type:"module"}):new Worker(new URL(""+new URL("../workers/worker-BAOIWoxA.js",import.meta.url).href,import.meta.url),{type:"module"}),this.#i()),this.#t({type:U.LOAD,data:r},void 0,o));exec=(e,r=-1,{signal:o}={})=>this.#t({type:U.EXEC,data:{args:e,timeout:r}},void 0,o);ffprobe=(e,r=-1,{signal:o}={})=>this.#t({type:U.FFPROBE,data:{args:e,timeout:r}},void 0,o);terminate=()=>{const e=Object.keys(this.#r);for(const r of e)this.#r[r]($r),delete this.#r[r],delete this.#a[r];this.#e&&(this.#e.terminate(),this.#e=null,this.loaded=!1)};writeFile=(e,r,{signal:o}={})=>{const n=[];return r instanceof Uint8Array&&n.push(r.buffer),this.#t({type:U.WRITE_FILE,data:{path:e,data:r}},n,o)};mount=(e,r,o)=>{const n=[];return this.#t({type:U.MOUNT,data:{fsType:e,options:r,mountPoint:o}},n)};unmount=e=>{const r=[];return this.#t({type:U.UNMOUNT,data:{mountPoint:e}},r)};readFile=(e,r="binary",{signal:o}={})=>this.#t({type:U.READ_FILE,data:{path:e,encoding:r}},void 0,o);deleteFile=(e,{signal:r}={})=>this.#t({type:U.DELETE_FILE,data:{path:e}},void 0,r);rename=(e,r,{signal:o}={})=>this.#t({type:U.RENAME,data:{oldPath:e,newPath:r}},void 0,o);createDir=(e,{signal:r}={})=>this.#t({type:U.CREATE_DIR,data:{path:e}},void 0,r);listDir=(e,{signal:r}={})=>this.#t({type:U.LIST_DIR,data:{path:e}},void 0,r);deleteDir=(e,{signal:r}={})=>this.#t({type:U.DELETE_DIR,data:{path:e}},void 0,r)}var ft;(function(a){a.MEMFS="MEMFS",a.NODEFS="NODEFS",a.NODERAWFS="NODERAWFS",a.IDBFS="IDBFS",a.WORKERFS="WORKERFS",a.PROXYFS="PROXYFS"})(ft||(ft={}));class kt{current_id=0;ids=[];ffmpeg_process_id=0;#e=N(ae({}));get messages(){return t(this.#e)}set messages(e){g(this.#e,e,!0)}log(e,r){this.add_message({message:e,error:!1},r)}error(e,r){this.add_message({message:`Error: ${e}`,error:!0},r)}add_message(e,r){r||(r=`message_${this.current_id}`,this.current_id+=1),this.ids.includes(r)||this.ids.push(r),this.messages={...this.messages,[r]:e},e.error?console.error(`${e.message} (${r})`):console.log(`${e.message} (${r})`)}reset(){this.current_id=0,this.ids=[],this.messages={},this.ffmpeg_process_id=0}bump_ffmpeg_process_id(){this.ffmpeg_process_id+=1}listen_ffmpeg_message=e=>{let r=`FFmpeg [${e.type}]: ${e.message}`;this.log(r,`ffmpeg_message_${this.ffmpeg_process_id}`)};listen_ffmpeg_progress=e=>{const r=e.progress*100;this.log(`FFmpeg [progress]: ${r.toFixed(2)}%`,`ffmpeg_progress_${this.ffmpeg_process_id}`)};toggle_ffmpeg_listen(e,r){r.manage_listeners(e,this.listen_ffmpeg_message,this.listen_ffmpeg_progress)}}const ta=""+new URL("../assets/ffmpeg-core.CI9Irx9p.js",import.meta.url).href,ra=""+new URL("../assets/ffmpeg-core.CgUfceKH.wasm",import.meta.url).href;class Et{ffmpeg_instance=null;ffmpeg_loaded=!1;get_instance(){return this.ffmpeg_instance}is_loaded(){return this.ffmpeg_loaded}async init(){if(!this.ffmpeg_loaded)try{this.ffmpeg_instance=new ea,await this.ffmpeg_instance.load({coreURL:ta,wasmURL:ra}),console.log("FFmpeg loaded successfully."),this.ffmpeg_loaded=!0}catch(e){throw console.error("Failed to load FFmpeg:",e),e}}manage_listeners(e,r,o){if(!this.ffmpeg_instance){console.error("FFmpeg is not initialized.");return}const n=e?"on":"off";this.ffmpeg_instance[n]("log",r),this.ffmpeg_instance[n]("progress",o)}}const aa=a=>new Promise((e,r)=>{const o=new FileReader;o.onload=()=>{const{result:n}=o;n instanceof ArrayBuffer?e(new Uint8Array(n)):e(new Uint8Array)},o.onerror=n=>{r(Error(`File could not be read! Code=${n?.target?.error?.code||-1}`))},o.readAsArrayBuffer(a)}),Ve=async a=>{let e;if(typeof a=="string")/data:_data\/([a-zA-Z]*);base64,([^"]*)/.test(a)?e=atob(a.split(",")[1]).split("").map(r=>r.charCodeAt(0)):e=await(await fetch(a)).arrayBuffer();else if(a instanceof URL)e=await(await fetch(a)).arrayBuffer();else if(a instanceof File||a instanceof Blob)e=await aa(a);else return new Uint8Array;return new Uint8Array(e)};function oa(a,e,r){const o=a.settings,n=na(e,r);return yt(e.name)&&ia(n),la(n,o),sa(n,a),da(n),n}function na(a,e){const r=["-i",a.name];return e&&(r.push("-i",e.name),r.push("-map","1:a:0")),r.push("-map","0:v:0"),r}function ia(a){a.unshift("-loop","1","-r","1"),a.push("-shortest","-r","1")}function sa(a,e){const r=[];if(e.crop.enabled&&r.push(`crop=${e.crop.width}:${e.crop.height}:${e.crop.x}:${e.crop.y}`),e.scale_down?r.push("scale=w=2048:h=2048:force_original_aspect_ratio=decrease:force_divisible_by=2"):r.push("pad=ceil(iw/2)*2:ceil(ih/2)*2"),r.length>0){const o=r.length>1?`"${r.join(",")}"`:r.join(",");a.push("-vf",o)}}function la(a,e){a.push("-c:v","libx264","-preset",e.preset),e.tune!=="none"&&a.push("-tune",e.tune),e.bitrate&&a.push("-b:v",`${e.bitrate}k`)}function da(a){a.push("-pix_fmt:v","yuv420p","output.mp4")}function ca(a,e,r){const o=a.settings,n=r&&a.remove_audio===!1,l=ua(e);return n&&fa(l,r),a.trim&&_a(l,a.trim),ma(l,o),va(l,a),n&&ha(l),ga(l),l}function ua(a){return["-i",a.name,"-map","0:v:0"]}function fa(a,e){a.push("-i",e.name,"-map","1:a:0")}function _a(a,e){const r=Math.floor(.9*e.start),o=e.start-r;a.unshift("-ss",fe(r)),a.push("-ss",fe(o)),a.push("-t",fe(e.end-e.start))}function va(a,e){const r=[];if(e.crop.enabled&&r.push(`crop=${e.crop.width}:${e.crop.height}:${e.crop.x}:${e.crop.y}`),e.scale_down&&r.push("scale=w=2048:h=2048:force_original_aspect_ratio=decrease"),r.length>0){const o=r.length>1?`"${r.join(",")}"`:r.join(",");a.push("-vf",o)}}function ma(a,e){a.push("-c:v","libvpx","-crf","10","-b:v",`${e.bitrate}k`)}function ha(a){a.push("-c:a","libvorbis","-b:a","256k")}function ga(a){a.push("output.webm")}function pa(a,e){const r=ba(e);return a.trim&&wa(r,a.trim),ya(r),xa(r),r}function ba(a){return["-i",a.name,"-map","0:a:0"]}function wa(a,e){const r=Math.floor(.9*e.start),o=e.start-r;a.unshift("-ss",fe(r)),a.push("-ss",fe(o)),a.push("-t",fe(e.end-e.start))}function ya(a){a.push("-c:a","libvorbis","-b:a","256k")}function xa(a){a.push("output.ogg")}function Rt(a,e,r){switch(a.output_format){case"mp4":return oa(a,e,r);case"webm":return ca(a,e,r);case"ogg":return pa(a,e);default:throw new Error(`Unsupported output format: ${a.output_format}`)}}async function _t(a,e,r,o,n){o.log("Writing input file to ffmpeg..."),await a.writeFile(e.name,await Ve(e.blob));const l=Rt(r,e);o.log("ffmpeg "+l.join(" ")),await a.exec(l),o.bump_ffmpeg_process_id(),o.log("Reading output...");const d=await a.readFile(`output.${r.output_format}`);return new Blob([d],{type:`${n}/${r.output_format}`})}const vt={progress:0,current_time:0,duration:0,start_progress:0,end_progress:1};var ka=I(`<div class="flash accent"><p><!> The cropped video exceeds the maximum resolution of 2048x2048 pixels and will be scaled
					down.</p></div>`),Ea=(a,e)=>{e()},Ra=I('<section class="flash px-2 bd-muted"><div class="media-container"><video>Your browser does not support the video tag.</video> <!></div> <section><!> <!></section></section> <div class="flash bd-muted"><label><input type="checkbox" name="upload_audio"/> Upload audio file to catbox.moe</label></div> <!> <!> <!> <button type="submit">Split</button>',3),Ma=I(`<div class="flash accent"><p>Filename: <code> </code></p> <p><small>Some browsers won't let you download files that contain '%' in the name. In that
							case, please copy and paste this filename.</small></p></div>`),La=I('<video controls></video> <a title="Download processedvideo"><button>Download</button></a> <!>',3),Sa=I("<!> <!>",1),Na=I(`<div class="flash bg-muted bd-muted"><p><b class="default">Instructions</b></p> <p>Upload a video, trim it and crop it.<br/>This tool will then split the audio and video into
			separate files.<br/> The audio file will automatically be uploaded to one of several hosts, with the URL embedded in
			the video's filename.</p></div>`),Oa=I("<!> <!>",1);function Fa(a,e){T(e,!0);let r=N(null),o=N(null),n=N(ae(vt)),l=N(!1);const s=new kt,d=new Et;let c=N("ready"),i=N(!0),v=N(ae({output_format:"mp4",settings:{preset:"fast",tune:"none",bitrate:2048},crop:xe()}));Ge(()=>{setInterval(function(){k(new Event("ontimeupdate"))},1/24*1e3),d.init()}),de(()=>{t(r)&&(g(n,vt,!0),g(c,"ready"))});let m=N(ae({name:"",blob:new Blob}));function w(M,A=!1){t(n).start_progress=M,t(n).start_progress>t(n).end_progress&&(t(n).end_progress=t(n).start_progress+.05),t(o)&&(A&&(t(o).currentTime=M*t(o).duration,g(l,!0)),t(n).progress<t(n).start_progress&&(t(n).progress=t(n).start_progress))}function y(M,A=!1){t(n).end_progress=M,t(n).end_progress<t(n).start_progress&&(t(n).start_progress=t(n).end_progress-.05),t(o)&&(A&&(t(o).currentTime=M*t(o).duration,g(l,!0)),t(n).progress>t(n).end_progress&&(t(n).progress=t(n).end_progress))}function x(M){t(o)&&(isNaN(t(o).duration)||(M<t(n).start_progress?t(n).progress=t(n).start_progress:M>t(n).end_progress&&(t(n).progress=t(n).end_progress),t(o).currentTime=M*t(o).duration,g(l,!1)))}function L(){t(o)&&(t(n).duration=t(o).duration)}function k(M){if(t(o)){if(t(l)){g(l,!1);return}t(n).progress=t(o).currentTime/t(o).duration,t(n).current_time=t(o).currentTime,t(n).progress<t(n).start_progress-.01?t(o).currentTime=t(n).start_progress*t(o).duration:t(n).progress>t(n).end_progress&&(t(o).loop?t(o).currentTime=t(n).start_progress*t(o).duration:(t(o).pause(),t(o).currentTime=t(n).end_progress*t(o).duration))}}async function O(M){const A=new FormData;A.append("reqtype","fileupload"),A.append("fileToUpload",M),s.log(`Uploading audio: ${M.name}...`);try{const u=await fetch("https://catbox.moe/user/api.php",{method:"POST",body:A});if(!u.ok)throw new Error(`Status: ${u.status}`);let h=await u.text();return s.log(h,"upload_audio_response"),h}catch(u){return console.error(u),null}}async function z(){s.reset(),g(c,"loading"),s.log("Splitting audio and video...");const M=d.get_instance();if(!M){s.error("FFmpeg instance is not available.");return}if(!t(r)){s.error("No file selected.");return}let A="";if(t(i)){const R=await _t(M,{name:t(r).name,blob:t(r)},{output_format:"ogg",trim:{start:t(n).start_progress*t(n).duration,end:t(n).end_progress*t(n).duration},crop:xe()},s,"audio").catch(S=>(s.error(S.message),null));if(!R){s.error("Failed to extract audio from video file.");return}let F=await O(new File([R],"extracted_audio.ogg"));if(!F){s.error("Failed to upload audio file.");return}A=encodeURIComponent(F)}const u=xe();u&&(t(v).crop=u);const h=await _t(M,{name:t(r).name,blob:t(r)},{...t(v),trim:{start:t(n).start_progress*t(n).duration,end:t(n).end_progress*t(n).duration},crop:xe()},s,"video").catch(R=>(s.error(R.message),null));if(!h){s.error("Failed to process video file.");return}const E=t(r).name.replace(/\.[^/.]+$/,"")+(A?`[sound=${A}]`:"");g(m,{name:E,blob:h},!0),s.log("Audio and video split successfully."),s.log(`Final video: ${t(m).name} (${t(m).blob.size} bytes)`),g(c,"finished")}var H=Oa(),J=D(H);gt(J,{accept_image:!1,show_preview:!1,get current_file(){return t(r)},set current_file(M){g(r,M,!0)}});var B=b(J,2);{var C=M=>{var A=G(),u=D(A);{var h=R=>{var F=Ra(),S=D(F),W=_(S),j=_(W);Oe(j,ee=>g(o,ee),()=>t(o));var Q=b(j,2);Or(Q,{get video(){return t(o)}}),f(W);var pe=b(W,2),_e=_(pe);ir(_e,{get video_data(){return t(n)},on_seek:x,on_start_seek:w,on_end_seek:y});var ve=b(_e,2);Mr(ve,{get video(){return t(o)},get video_data(){return t(n)}}),f(pe),f(S);var me=b(S,2),we=_(me),se=_(we);De(se),ge(),f(we),f(me);var le=b(me,2);{var ye=ee=>{var Ce=ka(),Ye=_(Ce),Lt=_(Ye);ur(Lt,{}),ge(),f(Ye),f(Ce),p(ee,Ce)};V(le,ee=>{(xe().width>2048||xe().height>2048)&&ee(ye)})}var Re=b(le,2);Cr(Re,{get video_data(){return t(n)},get export_settings(){return t(v)}});var Fe=b(Re,2);xt(Fe,{get file_name(){return t(r).name},get export_settings(){return t(v)},set export_settings(ee){g(v,ee,!0)}});var Mt=b(Fe,2);Mt.__click=[Ea,z],X(ee=>K(j,"src",ee),[()=>URL.createObjectURL(t(r))]),te("durationchange",j,L),te("resize",j,onresize),Qt(se,()=>t(i),ee=>g(i,ee)),p(R,F)},E=R=>{var F=Sa(),S=D(F);bt(S,{get message_manager(){return s},get ffmpeg_manager(){return d}});var W=b(S,2);{var j=Q=>{var pe=La(),_e=D(pe),ve=b(_e,2),me=b(ve,2);{var we=se=>{var le=Ma(),ye=_(le),Re=b(_(ye)),Fe=_(Re);f(Re),f(ye),ge(2),f(le),X(()=>Z(Fe,`${t(m).name??""}.${t(v).output_format??""}`)),p(se,le)};V(me,se=>{t(i)&&se(we)})}X((se,le)=>{K(_e,"src",se),K(ve,"href",le),K(ve,"download",t(m).name)},[()=>URL.createObjectURL(t(m).blob),()=>URL.createObjectURL(t(m).blob)]),p(Q,pe)};V(W,Q=>{t(c)==="finished"&&Q(j)})}p(R,F)};V(u,R=>{t(c)==="ready"?R(h):R(E,!1)})}p(M,A)},Y=M=>{var A=Na();p(M,A)};V(B,M=>{t(r)?M(C):M(Y,!1)})}p(a,H),P()}be(["click"]);var Ia=I("<video controls><source/> Your browser does not support the video tag.</video>",2),Da=I('<img alt="Selected image"/>'),Ua=I('<div class="flash bd-muted"><p><b>Preview</b></p> <p><code> </code></p> <!></div>');function mt(a,e){T(e,!0);var r=G(),o=D(r);{var n=l=>{var s=Ua(),d=b(_(s),2),c=_(d),i=_(c);f(c),f(d);var v=b(d,2);{var m=y=>{var x=Ia(),L=_(x);ge(),f(x),X(k=>{K(L,"src",k),K(L,"type",e.current_file.type)},[()=>URL.createObjectURL(e.current_file)]),p(y,x)},w=y=>{var x=G(),L=D(x);{var k=O=>{var z=Da();X(H=>K(z,"src",H),[()=>URL.createObjectURL(e.current_file)]),p(O,z)};V(L,O=>{Xe(e.current_file.name)==="image"&&O(k)},!0)}p(y,x)};V(v,y=>{Xe(e.current_file.name)==="video"?y(m):y(w,!1)})}f(s),X(y=>Z(i,`Original size: ${y??""}`),[()=>Ee(e.current_file.size,{units:"iec"})]),p(l,s)};V(o,l=>{e.current_file&&l(n)})}p(a,r),P()}async function Aa(a,e){const r=await fetch(a);if(!r.ok)throw new Error(`Failed to download file: ${r.statusText}`);const o=r.headers.get("Content-Length");if(!o)throw new Error("Unable to determine file size for progress tracking.");const n=parseInt(o,10);let l=0;const s=r.body?.getReader(),d=[];if(!s)throw new Error("Failed to read response body.");for(;;){const{done:i,value:v}=await s.read();if(i)break;if(v){d.push(v),l+=v.length;const m=l/n*100;e(m)}}return new Blob(d)}async function Ba(a,e,r,o,n){n.log("Merging video and audio..."),n.log("Writing input files to ffmpeg..."),await a.writeFile(e.name,await Ve(e.blob)),await a.writeFile(r.name,await Ve(r.blob));const l=Rt(o,e,r);n.log("ffmpeg "+l.join(" ")),await a.exec(l),n.bump_ffmpeg_process_id(),n.log("Reading output...");const d=await a.readFile(`output.${o.output_format}`);return new Blob([d],{type:`video/${o.output_format}`})}var Ca=(a,e)=>e(),Ta=I('<!> <div><!> <button type="submit">Merge</button></div>',1),Pa=I('<div class="flash bd-accent"><p><b>Output</b></p> <p><code> </code></p> <video controls></video> <p class="centered"><a><button>Download</button></a></p></div>',2),Wa=I("<!> <!>",1),ja=I('<p class="flash danger icon"><!> Cannot find sound URL / invalid sound URL in file <code class="bd-danger"> </code>.</p> <!>',1),za=I(`<div class="flash bg-muted bd-muted"><p><b>Instructions</b></p> <p>Upload a .webm file containing a [sound=URL] link in the filename.<br/> Example: <code>video[sound=https://example.com/sound.mp3].webm</code><br/> This tool
			downloads the linked sound file and merges it back into the video file for easy viewing.<br/>This is also useful for archival in case the file hosts go down.</p></div>`),Xa=I("<!> <!>",1);function Va(a,e){T(e,!0);let r=N(ae(new Blob));const o=new kt,n=new Et;let l=N("ready"),s=N(null),d=N(ae({output_format:"mp4",settings:{preset:"fast",tune:"none",bitrate:2048},crop:{enabled:!1,x:0,y:0,width:0,height:0}}));Ge(()=>{n.init()}),de(()=>{t(s)&&c()});function c(){g(r,new Blob,!0),o.reset(),g(l,"ready")}async function i(){if(!t(s)){o.error("No file selected for merging.");return}g(l,"loading");const k=await v(t(s).name);if(!k||!k.blob){o.error("Failed to download sound from file name.");return}let O={name:t(s).name,blob:t(s)};const z=n.get_instance();if(!z){o.error("FFmpeg instance is not available.");return}try{g(r,await Ba(z,O,k,t(d),o),!0)}catch(H){o.error(`FFmpeg error: ${H}`);return}g(l,"finished")}async function v(k){const O=ut(k);if(!O)return o.error("Invalid sound URL."),null;try{return{blob:await Aa(O,J=>{o.log(`Downloading sound... ${J.toFixed(2)}%`,"download_sound")}),name:`${encodeURIComponent(O)}`}}catch(z){return o.error(`Failed to download sound: ${z}`),null}}var m=Xa(),w=D(m);gt(w,{get current_file(){return t(s)},set current_file(k){g(s,k,!0)}});var y=b(w,2);{var x=k=>{var O=G(),z=D(O);{var H=B=>{var C=G(),Y=D(C);{var M=u=>{var h=Ta(),E=D(h);mt(E,{get current_file(){return t(s)}});var R=b(E,2),F=_(R);xt(F,{get file_name(){return t(s).name},get export_settings(){return t(d)},set export_settings(W){g(d,W,!0)}});var S=b(F,2);S.__click=[Ca,i],f(R),p(u,h)},A=u=>{var h=Wa(),E=D(h);bt(E,{get message_manager(){return o},get ffmpeg_manager(){return n}});var R=b(E,2);{var F=S=>{var W=Pa(),j=b(_(W),2),Q=_(j),pe=_(Q);f(Q),f(j);var _e=b(j,2),ve=b(_e,2),me=_(ve);f(ve),f(W),X((we,se,le,ye)=>{Z(pe,`Final size: ${we??""}`),K(_e,"src",se),K(me,"href",le),K(me,"download",`${ye??""}.webm`)},[()=>Ee(t(r).size,{units:"iec"}),()=>URL.createObjectURL(t(r)),()=>URL.createObjectURL(t(r)),()=>Yr(t(s).name)]),p(S,W)};V(R,S=>{t(l)==="finished"&&S(F)})}p(u,h)};V(Y,u=>{t(l)==="ready"?u(M):u(A,!1)})}p(B,C)},J=B=>{var C=ja(),Y=D(C),M=_(Y);dr(M,{});var A=b(M,2),u=_(A,!0);f(A),ge(),f(Y);var h=b(Y,2);mt(h,{get current_file(){return t(s)}}),X(()=>Z(u,t(s).name)),p(B,C)};V(z,B=>{ut(t(s).name)?B(H):B(J,!1)})}p(k,O)},L=k=>{var O=za();p(k,O)};V(y,k=>{t(s)?k(x):k(L,!1)})}p(a,m),P()}be(["click"]);let Ie=N(ae({open:!1,title:"",content:"",on_close:void 0}));var Ga=(a,e)=>t(e).on_close?.(),Ya=I('<dialog class="svelte-1dld0ml"><header><h2> </h2></header> <p> </p> <footer><form method="dialog"><button type="submit">Close</button></form></footer></dialog>');function Ha(a,e){T(e,!0);let r=N(null);de(()=>{t(r)&&t(Ie).open&&t(r).showModal()});var o=Ya(),n=_(o),l=_(n),s=_(l,!0);f(l),f(n);var d=b(n,2),c=_(d,!0);f(d);var i=b(d,2),v=_(i),m=_(v);m.__click=[Ga,Ie],f(v),f(i),f(o),Oe(o,w=>g(r,w),()=>t(r)),X(()=>{Z(s,t(Ie).title),Z(c,t(Ie).content)}),p(a,o),P()}be(["click"]);var Za=(a,e,r)=>g(e,t(r).name,!0),qa=I("<li> </li>"),Ka=I('<header class="my-4"><h3>Soundpost Tools</h3> <small>Utilities compatible with <a href="https://github.com/rcc11/4chan-sounds-player">4chan Sounds Player</a>, <a href="https://sleazyfork.org/en/scripts/31045-4chan-external-sounds">4chan External Sounds</a>, etc.</small></header> <main><menu></menu> <!> <!></main>',1);function ro(a){const e=[{name:"splitter",component:Fa,label:"WebM Maker"},{name:"merger",component:Va,label:"WebM Merger"}];let r=N("splitter");var o=Ka(),n=b(D(o),2),l=_(n);ke(l,21,()=>e,Ne,(c,i)=>{var v=qa();v.__click=[Za,r,i];let m;var w=_(v,!0);f(v),X(y=>{m=Se(v,1,"",null,m,y),Z(w,t(i).label)},[()=>({selected:t(r)===t(i).name})]),p(c,v)}),f(l);var s=b(l,2);ke(s,17,()=>e,c=>c.name,(c,i)=>{var v=G(),m=D(v);{var w=y=>{var x=G(),L=D(x);Ht(L,()=>t(i).component,(k,O)=>{O(k,{})}),p(y,x)};V(m,y=>{t(r)===t(i).name&&y(w)})}p(c,v)});var d=b(s,2);Ha(d,{}),f(n),p(a,o)}be(["click"]);export{ro as component};
